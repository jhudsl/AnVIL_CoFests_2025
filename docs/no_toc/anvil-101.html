<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 1 AnVIL 101 | AnVIL CoFests! 2025</title>
  <meta name="description" content="Description about Course/Book." />
  <meta name="generator" content="bookdown 0.43 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 1 AnVIL 101 | AnVIL CoFests! 2025" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Description about Course/Book." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 1 AnVIL 101 | AnVIL CoFests! 2025" />
  
  <meta name="twitter:description" content="Description about Course/Book." />
  



<meta name="date" content="2025-09-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="assets/AnVIL_style/anvil_favicon.ico" type="image/x-icon" />
<link rel="prev" href="organizer-guide.html"/>
<link rel="next" href="polygenic-risk-score-prs-mix-analysis-in-anvil.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
  
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id={MeasurementID}"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', '{MeasurementID}');
</script>
<base target="_blank">



<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="assets/style.css" type="text/css" />
<link rel="stylesheet" href="assets/AnVIL_style/anvil.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<a href="https://anvilproject.org/" target="_blank"><img src="assets/AnVIL_style/logo-anvil.png" style="width: 80%; padding-left: 15px; padding-top: 8px;"</a>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>What are CoFests!?</a></li>
<li class="chapter" data-level="" data-path="organizer-guide.html"><a href="organizer-guide.html"><i class="fa fa-check"></i>Organizer Guide</a>
<ul>
<li class="chapter" data-level="" data-path="organizer-guide.html"><a href="organizer-guide.html#final-product-report-out"><i class="fa fa-check"></i>Final Product / Report Out</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="anvil-101.html"><a href="anvil-101.html"><i class="fa fa-check"></i><b>1</b> AnVIL 101</a>
<ul>
<li class="chapter" data-level="1.1" data-path="anvil-101.html"><a href="anvil-101.html#about"><i class="fa fa-check"></i><b>1.1</b> About</a></li>
<li class="chapter" data-level="1.2" data-path="anvil-101.html"><a href="anvil-101.html#workspace"><i class="fa fa-check"></i><b>1.2</b> Workspace</a></li>
<li class="chapter" data-level="1.3" data-path="anvil-101.html"><a href="anvil-101.html#data-on-anvil"><i class="fa fa-check"></i><b>1.3</b> Data on AnVIL</a></li>
<li class="chapter" data-level="1.4" data-path="anvil-101.html"><a href="anvil-101.html#data-already-on-anvil-or-gcp"><i class="fa fa-check"></i><b>1.4</b> Data already on AnVIL (or GCP)</a></li>
<li class="chapter" data-level="1.5" data-path="anvil-101.html"><a href="anvil-101.html#data-from-a-public-repository"><i class="fa fa-check"></i><b>1.5</b> Data from a public repository</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="anvil-101.html"><a href="anvil-101.html#data-from-sra"><i class="fa fa-check"></i><b>1.5.1</b> Data from SRA</a></li>
<li class="chapter" data-level="1.5.2" data-path="anvil-101.html"><a href="anvil-101.html#buckets-and-persistent-disks"><i class="fa fa-check"></i><b>1.5.2</b> Buckets and persistent disks</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="anvil-101.html"><a href="anvil-101.html#data-from-a-protected-source"><i class="fa fa-check"></i><b>1.6</b> Data from a protected source</a></li>
<li class="chapter" data-level="1.7" data-path="anvil-101.html"><a href="anvil-101.html#bring-your-own-data"><i class="fa fa-check"></i><b>1.7</b> Bring your own data</a></li>
<li class="chapter" data-level="1.8" data-path="anvil-101.html"><a href="anvil-101.html#shut-down-environments"><i class="fa fa-check"></i><b>1.8</b> Shut down environments</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="polygenic-risk-score-prs-mix-analysis-in-anvil.html"><a href="polygenic-risk-score-prs-mix-analysis-in-anvil.html"><i class="fa fa-check"></i><b>2</b> Polygenic Risk Score (PRS) Mix Analysis in AnVIL</a>
<ul>
<li class="chapter" data-level="2.1" data-path="polygenic-risk-score-prs-mix-analysis-in-anvil.html"><a href="polygenic-risk-score-prs-mix-analysis-in-anvil.html#about-1"><i class="fa fa-check"></i><b>2.1</b> About</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="anvil-mini-hack-reproducibility-in-action.html"><a href="anvil-mini-hack-reproducibility-in-action.html"><i class="fa fa-check"></i><b>3</b> AnVIL Mini Hack: Reproducibility in Action!</a>
<ul>
<li class="chapter" data-level="3.1" data-path="anvil-mini-hack-reproducibility-in-action.html"><a href="anvil-mini-hack-reproducibility-in-action.html#about-2"><i class="fa fa-check"></i><b>3.1</b> About</a></li>
<li class="chapter" data-level="3.2" data-path="anvil-mini-hack-reproducibility-in-action.html"><a href="anvil-mini-hack-reproducibility-in-action.html#workspace-1"><i class="fa fa-check"></i><b>3.2</b> Workspace</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="about-the-authors.html"><a href="about-the-authors.html"><i class="fa fa-check"></i>About the Authors</a></li>
<li class="chapter" data-level="4" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>4</b> References</a></li>
<li class="divider"></li>
<p style="text-align:center;"> <a href="https://github.com/jhudsl/OTTR_Template" target="blank" > This content was published with</a> <a href="https://bookdown.org/" target="blank"> bookdown by: </a> </p>
<p style="text-align:center;"> <a href="https://hutchdatascience.org/"> The Fred Hutch Data Science Lab </a></p>
<a href="https://hutchdatascience.org/" target="_blank"><img src="https://raw.githubusercontent.com/jhudsl/OTTR_Template/main/style-sets/fhdasl/copy_to_assets/big-dasl-stacked.png" style="width: 80%; padding-left: 34px; padding-top: 8px;"</a>
<p style="text-align:center; font-size: 12px;"> <a href="https://github.com/rstudio4edu/rstudio4edu-book/"> Style adapted from: rstudio4edu-book </a> <a href ="https://creativecommons.org/licenses/by/2.0/"> (CC-BY 2.0) </a></p>
<p style="padding-left: 40px;"><div class="trapezoid" style = "padding-left: 40px;"><span><a href="https://docs.google.com/forms/d/e/1FAIpQLScrDVb_utm55pmb_SHx-RgELTEbCCWdLea0T3IzS0Oj00GE4w/viewform?usp=pp_url&entry.1565230805=your+course"> Click here to provide feedback</a> <img src="assets/itcr_arrow.png" style=" width: 10%" ></span></div></p>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">AnVIL CoFests! 2025</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<head>
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=10.0,initial-scale=1.0">
  <!--script src="https://kit.fontawesome.com/6a26f47516.js"></script-->
  <!--<script src="assets/hideOutput.js"></script>-->
</head>
        


<div class="hero-image-container"> 
  <img class= "hero-image" src="assets/AnVIL_style/dasl_thin_main_image.png">
</div>
<div id="anvil-101" class="section level1 hasAnchor" number="1">
<h1><span class="header-section-number">Chapter 1</span> AnVIL 101<a href="anvil-101.html#anvil-101" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Led by: Ava Hoffman, Fred Hutch Cancer Center</p>
<p><br><br></p>
<div id="about" class="section level2 hasAnchor" number="1.1">
<h2><span class="header-section-number">1.1</span> About<a href="anvil-101.html#about" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This track will consist of both an overview and a hands-on workshop to provide individuals with a starting point to their work on AnVIL.</p>
<p>Participants are not required to supply their own data, as publicly available data and an AnVIL workspace will be provided as part of the CoFest track.</p>
<p>You can follow along with the agenda on Google Docs <a href="https://docs.google.com/document/d/1xnnZTpxBy3WCqIBHTG6QtFNWnBa42RZxCeyxNGibE6o/edit?tab=t.0">here</a>.</p>
</div>
<div id="workspace" class="section level2 hasAnchor" number="1.2">
<h2><span class="header-section-number">1.2</span> Workspace<a href="anvil-101.html#workspace" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The workspace for this track can be found at:</p>
<p><a href="https://anvil.terra.bio/#workspaces/anvil-outreach/AnVIL101-CoFest2025" class="uri">https://anvil.terra.bio/#workspaces/anvil-outreach/AnVIL101-CoFest2025</a></p>
</div>
<div id="data-on-anvil" class="section level2 hasAnchor" number="1.3">
<h2><span class="header-section-number">1.3</span> Data on AnVIL<a href="anvil-101.html#data-on-anvil" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Gathering your data is one of the first steps of any analysis (assuming you already have your research question in mind!). Working on AnVIL, you might be using data from a few different places:</p>
<ul>
<li>Data already on AnVIL (or GCP)</li>
<li>Data from a public repository (such as <a href="https://www.ncbi.nlm.nih.gov/sra">SRA</a>)</li>
<li>Data from a protected source (such as <a href="https://dbgap.ncbi.nlm.nih.gov/home">dbGaP</a>)</li>
<li>Data from your own source (such as your laptop or an institutional HPC)</li>
</ul>
<!-- schematic of data sources -->
</div>
<div id="data-already-on-anvil-or-gcp" class="section level2 hasAnchor" number="1.4">
<h2><span class="header-section-number">1.4</span> Data already on AnVIL (or GCP)<a href="anvil-101.html#data-already-on-anvil-or-gcp" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Luckily, if data is already on AnVIL, there is less you have to do to start working with it. Under the hood, AnVIL uses <a href="https://cloud.google.com/">Google Cloud Platform</a> (GCP) to store data. Each data file will therefore get a Google Cloud URI that starts with <code>gs://</code>. These URIs can be referenced inside workflows and copied into analysis environments.</p>
<blockquote>
<p>Within the context of Google Cloud Storage, the GCP URI is a Uniform Resource Identifier that points to a specific resource, such as a bucket or an object (file), within Cloud Storage.</p>
</blockquote>
<p>Some consortia have created AnVIL Workspaces to organize their data. If you clone (copy) these workspaces, links to the data will be copied as well. You can then point to these links in WDL workflows, or copy these data into interactive compute environments (like Galaxy, RStudio, or Jupyter Notebooks/Terminal environment).</p>
<p>If your data is already stored in GCP, you can use the links directly.</p>
</div>
<div id="data-from-a-public-repository" class="section level2 hasAnchor" number="1.5">
<h2><span class="header-section-number">1.5</span> Data from a public repository<a href="anvil-101.html#data-from-a-public-repository" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>If our data is located elsewhere, such as in <a href="https://www.ncbi.nlm.nih.gov/sra">SRA</a>, we will need to bring the data into AnVIL/GCP storage. We could manually upload and download data, but that could take a long time, and might get interrupted if our computer or internet connection acts up. Better that we cut out the middle step, and have the SRA talk directly to AnVIL!</p>
<p>In the next steps, we’ll copy over some SRA data (in FASTQ format) to AnVIL. Our goal is to get some RNA-Seq data associated with <a href="https://pubmed.ncbi.nlm.nih.gov/31150625/">this study</a>.</p>
<div id="data-from-sra" class="section level3 hasAnchor" number="1.5.1">
<h3><span class="header-section-number">1.5.1</span> Data from SRA<a href="anvil-101.html#data-from-sra" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li><p>Clone the Workspace. Use the billing project provided by your instructor, or one of your choice. You might want to call the workspace “AnVIL101-CoFest2025-{your name here}”, because workspace names on the same billing project must be unique.</p></li>
<li><p>Go to the “WORKFLOWS” tab. We’ll use a WDL workflow to make sure the SRA data is in GCP and accessible in AnVIL.</p></li>
<li><p>Click “Find a Workflow”. Click on “Dockstore.org”.</p></li>
<li><p>Once on Dockstore, browse for “SRA fetch”. Scroll down a bit to find “aofarrel/SRANWRP/pull_FASTQs_from_SRA_by_run”. Click on this workflow, or go directly to it <a href="https://dockstore.org/workflows/github.com/aofarrel/SRANWRP/pull_FASTQs_from_SRA_by_run:v1.1.18?tab=info">here</a>.</p></li>
<li><p>On the righthand side, find “Launch with” and select “AnVIL”. On the dropdown for “Destination Workspace” select the workspace clone you made above (“AnVIL101-CoFest2025-{your name here}”).</p></li>
<li><p>Back on AnVIL, select the workflow you just imported (“pull_FASTQs_from_SRA_by_run”).</p></li>
<li><p>In the box under “Input value” for the “sra_accessions” variable, enter an SRA accession listed at the site here: <a href="https://www.ncbi.nlm.nih.gov/Traces/study/?acc=SRP131764&amp;o=acc_s%3Aa" class="uri">https://www.ncbi.nlm.nih.gov/Traces/study/?acc=SRP131764&amp;o=acc_s%3Aa</a>. It should start with “SRR”. Don’t forget quotation marks (e.g., “SRR6652526”).</p></li>
<li><p>Click the “Save” button. Then, click “Launch”. Click “Launch” again to confirm. It will take 5-6 minutes.</p></li>
</ol>
</div>
<div id="buckets-and-persistent-disks" class="section level3 hasAnchor" number="1.5.2">
<h3><span class="header-section-number">1.5.2</span> Buckets and persistent disks<a href="anvil-101.html#buckets-and-persistent-disks" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>By running the workflow above, we brought some data into GCP using AnVIL, into something called a “bucket”. A Google bucket, more formally known as a Cloud Storage bucket, is a fundamental container for data in Google Cloud Storage. Buckets are used to organize objects (files of any format) and control access to them.</p>
<p>On AnVIL, you’ll need to think about storage and computing being different computers. We’ll have to move any data we want to analyze into a computing environment’s “persistent disk”.</p>
<ol style="list-style-type: decimal">
<li><p>While your workflow submitted above is running, launch a Jupyter notebook. Go to “ANALYSES” tab, click “Start” and name your notebook. Default parameters and Python can be used.</p></li>
<li><p>After the Jupyter environment starts provisioning, check the status of your workflow under the “SUBMISSION HISTORY” tab. Click on the “Submission ID” to see the output on GCP.</p></li>
<li><p>Locate your files by clicking through the folders. On the three-dot menu, you can copy the gsutil URI. We can use this link to bring our data into an AnVIL compute environment.</p></li>
<li><p>Navigate back to the Jupyter Notebook. Click the “Terminal” icon on the righthand side. Check out the files you have in this compute environment with <code>ls</code>. You can also see the GCP info, including the workspace bucket with <code>gcloud storage ls</code>.</p></li>
</ol>
<blockquote>
<p>Remember that GCP storage (data “in the workspace”) differs from the temporary storage associated with a Jupyter computing environment’s persistent disk. You’ll need to move data back and forth.</p>
</blockquote>
<ol start="5" style="list-style-type: decimal">
<li>Bring data into this computing environment: <code>gcloud storage cp {URI HERE} .</code>. Type <code>ls</code> again to confirm the file is now available for you to work with.</li>
</ol>
<p>In the next steps, we’ll shift gears a bit to examine some processed data.</p>
</div>
</div>
<div id="data-from-a-protected-source" class="section level2 hasAnchor" number="1.6">
<h2><span class="header-section-number">1.6</span> Data from a protected source<a href="anvil-101.html#data-from-a-protected-source" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You can also use workflows to get data from a protected source.</p>
<p>For example, you can use workflows to get data from <a href="https://dbgap.ncbi.nlm.nih.gov/home">dbGaP</a>, if it’s not already available on AnVIL/GCP somewhere. Here are two WDL workflows in <a href="https://dockstore.org/">Dockstore</a> for doing this type of work:</p>
<ul>
<li>From the Broad Institute’s Manning Lab: <code>manning-lab/fetch-dbgap-data-workflow</code></li>
<li>From the UW Genetic Analysis Center: <code>UW-GAC/fetch-dbgap-files</code></li>
</ul>
</div>
<div id="bring-your-own-data" class="section level2 hasAnchor" number="1.7">
<h2><span class="header-section-number">1.7</span> Bring your own data<a href="anvil-101.html#bring-your-own-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>If you are bringing your own data to AnVIL, you’ll likely need to transfer data from an institutional high-performance computing (HPC) resource or from your personal computer.</p>
<p>HPC access and setups vary from institution to institution. Here, we’ll walk through how to upload a file from your computer.</p>
<ol style="list-style-type: decimal">
<li><p>Click on the “DATA” tab. Locate the “Browse workspace files” icon on the righthand side.</p></li>
<li><p>Click the “Upload” button and upload this file: <a href="https://genomicseducation.org/data/mouse_gutbrain_de_counts_controls.csv" class="uri">https://genomicseducation.org/data/mouse_gutbrain_de_counts_controls.csv</a>. You might need to right-click to save this file to your local machine.</p></li>
<li><p>Navigate to the “ANALYSES” tab. Select the <code>mouse_gutbrain_DE.ipynb</code> notebook. Click “Open”.</p></li>
<li><p>Follow along with the instructions in the notebook to perform some analyses!</p></li>
</ol>
</div>
<div id="shut-down-environments" class="section level2 hasAnchor" number="1.8">
<h2><span class="header-section-number">1.8</span> Shut down environments<a href="anvil-101.html#shut-down-environments" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A good practice to control costs is to shut down any computing environments when you’re done. This:</p>
<ul>
<li>Deletes any data you imported or created in your persistent disk</li>
<li>DOES NOT delete any data in the workspace bucket or code in .ipynb notebooks</li>
</ul>
<p>For this activity, you can keep environments going if you want to continue to experiment. We will shut down the environment automatically at the end of the day. If you want to shut things down immediately, you should:</p>
<ol style="list-style-type: decimal">
<li><p>Click on the Jupyter logo. Click on “Settings”.</p></li>
<li><p>Click on “Delete Environment”. Select “Delete everything, including persistent disk” and click “Delete”.</p></li>
</ol>
<blockquote>
<p>You can also go to <a href="https://anvil.terra.bio/#clusters" class="uri">https://anvil.terra.bio/#clusters</a> to see if you are accruing any analysis costs.</p>
</blockquote>

</div>
</div>
<hr>
<center> 
  <div class="footer">
      All illustrations <a href="https://creativecommons.org/licenses/by/4.0/">CC-BY. </a>
      <br>
      All other materials <a href= "https://creativecommons.org/licenses/by/4.0/"> CC-BY </a> unless noted otherwise.
  </div>
</center>
            </section>

          </div>
        </div>
      </div>
<a href="organizer-guide.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="polygenic-risk-score-prs-mix-analysis-in-anvil.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": null,
    "text": null
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "section"
  }
});
});
</script>

</body>

</html>
